<!DOCTYPE html>
<html>
<head>
    <title>Surgical Boost | Khushee Singh</title>
    <style>
        body { background: #0b0e11; color: #fff; font-family: 'Inter', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: #15191c; border: 1px solid #ff1744; padding: 40px; border-radius: 20px; width: 400px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .pct { font-size: 5rem; font-weight: 800; color: #ff1744; margin: 10px 0; }
        input[type="range"] { width: 100%; accent-color: #ff1744; margin: 25px 0; cursor: pointer; }
        button { background: #ff1744; color: white; border: none; padding: 18px; border-radius: 10px; font-weight: bold; width: 100%; cursor: pointer; font-size: 1.1rem; }
        .status { margin-top: 20px; font-size: 0.8rem; color: #5c636a; border-top: 1px solid #2d3339; padding-top: 15px; }
    </style>
</head>
<body>

<div class="card">
    <h2 style="margin:0; letter-spacing:-1px;">Khushee Singh</h2>
    <p style="color:#5c636a; font-size:0.8rem;">singhkhushee99@gmail.com</p>
    
    <div class="pct" id="val">50%</div>
    <input type="range" id="slide" min="10" max="90" value="50" oninput="document.getElementById('val').innerText = this.value + '%'">
    
    <button onclick="injectSurgical()">üöÄ Apply Silent Boost</button>
    <div class="status" id="log">Ready to inject...</div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
    import { getFirestore, collection, query, where, getDocs, doc, updateDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";

    const firebaseConfig = { 
        apiKey: "AIzaSyByqcto5JMr3BWJyemb9Q2XLi8OSBRfaTw", 
        authDomain: "students-view.firebaseapp.com", 
        projectId: "students-view" 
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    window.injectSurgical = async () => {
        const log = document.getElementById('log');
        const targetPct = parseInt(document.getElementById('slide').value);
        log.innerText = "Accessing Cloud Database...";

        const q = query(collection(db, "user_progress"), where("email", "==", "singhkhushee99@gmail.com"));
        const snap = await getDocs(q);
        
        if (snap.empty) {
            log.innerText = "‚ùå Error: Khushee's email not found.";
            return;
        }

        // MATCHING DASHBOARD (1).HTML: Exactly 19 videos
        const TOTAL_VIDEOS = 19; 
        const mockProgress = {};
        
        // Calculate how many videos to mark as 100% finished
        const vidsToFill = Math.floor(TOTAL_VIDEOS * (targetPct / 100));

        for(let i=0; i < TOTAL_VIDEOS; i++) {
            // We use 600 seconds (10 mins) as a standard video length
            if (i < vidsToFill) {
                mockProgress[i] = new Array(600).fill(1); // 100% watched
            } else if (i === vidsToFill) {
                // Partial fill for the current video to reach exact %
                mockProgress[i] = new Array(600).fill(0).map((_, idx) => idx < 150 ? 1 : 0);
            } else {
                mockProgress[i] = new Array(600).fill(0); // Unwatched
            }
        }

        try {
            const userDocId = snap.docs[0].id;
            await updateDoc(doc(db, "user_progress", userDocId), {
                progress: mockProgress,
                lastUpdated: serverTimestamp(),
                // Keep her original name so nothing looks suspicious
                name: "Khushee Singh" 
            });
            log.innerText = "‚úÖ Magic Applied! Refresh your Analytics Dashboard.";
            alert("Success! 19-video structure injected for Khushee.");
        } catch (e) {
            log.innerText = "‚ùå Injection failed: " + e.message;
        }
    };
</script>
</body>
</html>
